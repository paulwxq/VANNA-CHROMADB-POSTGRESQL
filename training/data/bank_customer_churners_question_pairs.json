[
  {
    "question": "当前信用卡客户总数是多少？",
    "sql": "SELECT COUNT(*) FROM bank_churners;"
  },
  {
    "question": "目前流失的信用卡客户数量和流失率是多少？",
    "sql": "SELECT COUNT(*) AS churned_customers, ROUND(COUNT(*) * 100.0 / (SELECT COUNT(*) FROM bank_churners), 2) AS churn_rate FROM bank_churners WHERE attrition_flag = 'Attrited Customer';"
  },
  {
    "question": "不同性别的信用卡客户流失率分别是多少？",
    "sql": "SELECT gender, ROUND(SUM(CASE WHEN attrition_flag = 'Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*), 2) AS churn_rate FROM bank_churners GROUP BY gender;"
  },
  {
    "question": "各年龄段客户的流失率如何？",
    "sql": "SELECT CASE WHEN customer_age<30 THEN '<30' WHEN customer_age BETWEEN 30 AND 39 THEN '30-39' WHEN customer_age BETWEEN 40 AND 49 THEN '40-49' WHEN customer_age BETWEEN 50 AND 59 THEN '50-59' ELSE '60+' END AS age_group, ROUND(SUM(CASE WHEN attrition_flag='Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners GROUP BY CASE WHEN customer_age<30 THEN '<30' WHEN customer_age BETWEEN 30 AND 39 THEN '30-39' WHEN customer_age BETWEEN 40 AND 49 THEN '40-49' WHEN customer_age BETWEEN 50 AND 59 THEN '50-59' ELSE '60+' END;"
  },
  {
    "question": "不同收入等级的客户流失率是多少？",
    "sql": "SELECT income_category, ROUND(SUM(CASE WHEN attrition_flag = 'Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*), 2) AS churn_rate FROM bank_churners GROUP BY income_category;"
  },
  {
    "question": "流失客户的平均年龄是多少？",
    "sql": "SELECT AVG(customer_age) AS avg_age FROM bank_churners WHERE attrition_flag='Attrited Customer';"
  },
  {
    "question": "各类信用卡（卡类别）的客户流失率是多少？",
    "sql": "SELECT card_category, ROUND(SUM(CASE WHEN attrition_flag = 'Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners GROUP BY card_category;"
  },
  {
    "question": "流失客户的平均信用额度是多少？",
    "sql": "SELECT AVG(credit_limit) AS avg_credit_limit FROM bank_churners WHERE attrition_flag='Attrited Customer';"
  },
  {
    "question": "不同婚姻状况的客户流失率对比？",
    "sql": "SELECT marital_status, ROUND(SUM(CASE WHEN attrition_flag='Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners GROUP BY marital_status;"
  },
  {
    "question": "家庭成员数不同的客户，其流失率有何差异？",
    "sql": "SELECT dependent_count, ROUND(SUM(CASE WHEN attrition_flag='Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners GROUP BY dependent_count ORDER BY dependent_count;"
  },
  {
    "question": "学历水平不同的客户流失率？",
    "sql": "SELECT education_level, ROUND(SUM(CASE WHEN attrition_flag='Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners GROUP BY education_level;"
  },
  {
    "question": "现有客户与流失客户在信用额度上的分布情况如何？",
    "sql": "SELECT attrition_flag, MIN(credit_limit) AS min_credit_limit, MAX(credit_limit) AS max_credit_limit, AVG(credit_limit) AS avg_credit_limit FROM bank_churners GROUP BY attrition_flag;"
  },
  {
    "question": "哪类客户的平均信用卡利用率最高？",
    "sql": "SELECT attrition_flag, AVG(avg_utilization_ratio) AS avg_utilization_ratio FROM bank_churners GROUP BY attrition_flag;"
  },
  {
    "question": "总共有多少高额度客户（额度超2万元）？",
    "sql": "SELECT COUNT(*) FROM bank_churners WHERE credit_limit > 20000;"
  },
  {
    "question": "持卡时长（月）大于36个月的客户流失率是多少？",
    "sql": "SELECT ROUND(SUM(CASE WHEN attrition_flag='Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE months_on_book > 36;"
  },
  {
    "question": "客户平均交易总金额是多少？",
    "sql": "SELECT AVG(total_trans_amt) AS avg_total_trans_amt FROM bank_churners;"
  },
  {
    "question": "流失客户的平均月交易次数是多少？",
    "sql": "SELECT AVG(total_trans_ct) AS avg_total_trans_ct FROM bank_churners WHERE attrition_flag='Attrited Customer';"
  },
  {
    "question": "流失客户和现有客户的交易金额变化率对比？",
    "sql": "SELECT attrition_flag, AVG(total_amt_chng_q4_q1) AS avg_amt_chng_q4_q1 FROM bank_churners GROUP BY attrition_flag;"
  },
  {
    "question": "本季度与上季度交易次数变化率高于1的客户流失率？",
    "sql": "SELECT ROUND(SUM(CASE WHEN attrition_flag='Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE total_ct_chng_q4_q1 > 1;"
  },
  {
    "question": "循环余额大于5000元的客户中，流失率是多少？",
    "sql": "SELECT ROUND(SUM(CASE WHEN attrition_flag='Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE total_revolving_bal > 5000;"
  },
  {
    "question": "本季度交易总金额超过5000元的客户流失率？",
    "sql": "SELECT ROUND(SUM(CASE WHEN attrition_flag='Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE total_trans_amt > 5000;"
  },
  {
    "question": "交易次数最多的前5位客户是谁？",
    "sql": "SELECT client_num, total_trans_ct FROM bank_churners ORDER BY total_trans_ct DESC LIMIT 5;"
  },
  {
    "question": "持有金卡客户的流失率是多少？",
    "sql": "SELECT ROUND(SUM(CASE WHEN attrition_flag='Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE card_category='Gold';"
  },
  {
    "question": "近一年新客户（开户小于12个月）的流失率？",
    "sql": "SELECT ROUND(SUM(CASE WHEN attrition_flag='Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE months_on_book < 12;"
  },
  {
    "question": "信用额度低于5000元的客户流失率？",
    "sql": "SELECT ROUND(SUM(CASE WHEN attrition_flag='Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE credit_limit < 5000;"
  },
  {
    "question": "家庭成员数超过3人的客户流失率？",
    "sql": "SELECT ROUND(SUM(CASE WHEN attrition_flag='Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE dependent_count > 3;"
  },
  {
    "question": "高学历客户（Graduate及以上）的流失率？",
    "sql": "SELECT ROUND(SUM(CASE WHEN attrition_flag='Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE education_level IN ('Graduate', 'Doctorate', 'Post-Graduate');"
  },
  {
    "question": "预测概率大于0.8的高风险客户有多少？",
    "sql": "SELECT COUNT(*) FROM bank_churners WHERE nb_classifier_attrition_flag_1 > 0.8;"
  },
  {
    "question": "各收入等级的平均信用额度是多少？",
    "sql": "SELECT income_category, AVG(credit_limit) AS avg_credit_limit FROM bank_churners GROUP BY income_category;"
  },
  {
    "question": "流失概率排名前10的客户编号及其概率？",
    "sql": "SELECT client_num, nb_classifier_attrition_flag_1 AS churn_probability FROM bank_churners ORDER BY nb_classifier_attrition_flag_1 DESC LIMIT 10;"
  },
  {
    "question": "信用卡平均额度使用率最高的前5位客户编号？",
    "sql": "SELECT client_num, avg_utilization_ratio FROM bank_churners ORDER BY avg_utilization_ratio DESC LIMIT 5;"
  },
  {
    "question": "近三年内开户的客户流失率如何？",
    "sql": "SELECT ROUND(SUM(CASE WHEN attrition_flag = 'Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE months_on_book <= 36;"
  },
  {
    "question": "信用卡额度大于15000且本季度交易金额高于3000元的客户流失率是多少？",
    "sql": "SELECT ROUND(SUM(CASE WHEN attrition_flag = 'Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE credit_limit > 15000 AND total_trans_amt > 3000;"
  },
  {
    "question": "信用额度在5000至10000之间的客户平均月交易次数是多少？",
    "sql": "SELECT AVG(total_trans_ct) AS avg_total_trans_ct FROM bank_churners WHERE credit_limit BETWEEN 5000 AND 10000;"
  },
  {
    "question": "家庭成员数为0的客户，其平均交易金额与流失率分别是多少？",
    "sql": "SELECT AVG(total_trans_amt) AS avg_total_trans_amt, ROUND(SUM(CASE WHEN attrition_flag = 'Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE dependent_count = 0;"
  },
  {
    "question": "近一年内流失的客户中，年龄最小和最大的客户分别是多少岁？",
    "sql": "SELECT MIN(customer_age) AS min_age, MAX(customer_age) AS max_age FROM bank_churners WHERE attrition_flag = 'Attrited Customer' AND months_on_book <= 12;"
  },
  {
    "question": "平均额度使用率在0.5以上的客户流失率如何？",
    "sql": "SELECT ROUND(SUM(CASE WHEN attrition_flag = 'Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE avg_utilization_ratio > 0.5;"
  },
  {
    "question": "已婚客户与未婚客户的平均家庭成员数量分别是多少？",
    "sql": "SELECT marital_status, AVG(dependent_count) AS avg_dependent_count FROM bank_churners WHERE marital_status IN ('Married','Single') GROUP BY marital_status;"
  },
  {
    "question": "循环余额为0的客户流失率是多少？",
    "sql": "SELECT ROUND(SUM(CASE WHEN attrition_flag = 'Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE total_revolving_bal = 0;"
  },
  {
    "question": "本季度交易金额最低的前10位客户编号及其交易金额？",
    "sql": "SELECT client_num, total_trans_amt FROM bank_churners ORDER BY total_trans_amt ASC LIMIT 10;"
  },
  {
    "question": "女性客户的平均信用额度和流失率分别是多少？",
    "sql": "SELECT AVG(credit_limit) AS avg_credit_limit, ROUND(SUM(CASE WHEN attrition_flag = 'Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE gender = 'F';"
  },
  {
    "question": "客户年龄与平均额度使用率的相关性如何？",
    "sql": "SELECT CORR(customer_age, avg_utilization_ratio) AS age_utilization_corr FROM bank_churners;"
  },
  {
    "question": "学历为'Uneducated'的客户流失率是多少？",
    "sql": "SELECT ROUND(SUM(CASE WHEN attrition_flag = 'Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE education_level = 'Uneducated';"
  },
  {
    "question": "平均每位客户的家庭成员数是多少？",
    "sql": "SELECT AVG(dependent_count) AS avg_dependent_count FROM bank_churners;"
  },
  {
    "question": "近一年客户的平均交易次数与流失客户的平均交易次数对比？",
    "sql": "SELECT attrition_flag, AVG(total_trans_ct) AS avg_total_trans_ct FROM bank_churners WHERE months_on_book <= 12 GROUP BY attrition_flag;"
  },
  {
    "question": "不同性别客户的平均信用额度是多少？",
    "sql": "SELECT gender, AVG(credit_limit) AS avg_credit_limit FROM bank_churners GROUP BY gender;"
  },
  {
    "question": "家庭成员数最多的前5位客户编号及其家庭成员数？",
    "sql": "SELECT client_num, dependent_count FROM bank_churners ORDER BY dependent_count DESC LIMIT 5;"
  },
  {
    "question": "本季度交易金额最高的客户编号和金额？",
    "sql": "SELECT client_num, total_trans_amt FROM bank_churners ORDER BY total_trans_amt DESC LIMIT 1;"
  },
  {
    "question": "持卡时长最长的客户编号及其时长？",
    "sql": "SELECT client_num, months_on_book FROM bank_churners ORDER BY months_on_book DESC LIMIT 1;"
  },
  {
    "question": "每个学历层次客户的平均交易金额是多少？",
    "sql": "SELECT education_level, AVG(total_trans_amt) AS avg_total_trans_amt FROM bank_churners GROUP BY education_level;"
  },
  {
    "question": "不同婚姻状况客户的平均信用卡额度是多少？",
    "sql": "SELECT marital_status, AVG(credit_limit) AS avg_credit_limit FROM bank_churners GROUP BY marital_status;"
  },
  {
    "question": "不同卡类别客户的平均月交易次数是多少？",
    "sql": "SELECT card_category, AVG(total_trans_ct) AS avg_total_trans_ct FROM bank_churners GROUP BY card_category;"
  },
  {
    "question": "不同收入等级客户的平均额度使用率是多少？",
    "sql": "SELECT income_category, AVG(avg_utilization_ratio) AS avg_utilization_ratio FROM bank_churners GROUP BY income_category;"
  },
  {
    "question": "近两年（开户24个月及以内）客户的总数及流失率？",
    "sql": "SELECT COUNT(*) AS customer_count, ROUND(SUM(CASE WHEN attrition_flag='Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE months_on_book <= 24;"
  },
  {
    "question": "男性与女性客户的平均交易金额和交易次数？",
    "sql": "SELECT gender, AVG(total_trans_amt) AS avg_total_trans_amt, AVG(total_trans_ct) AS avg_total_trans_ct FROM bank_churners GROUP BY gender;"
  },
  {
    "question": "利用率为零客户的数量和流失率？",
    "sql": "SELECT COUNT(*) AS customer_count, ROUND(SUM(CASE WHEN attrition_flag='Attrited Customer' THEN 1 ELSE 0 END)*100.0/COUNT(*),2) AS churn_rate FROM bank_churners WHERE avg_utilization_ratio = 0;"
  }
]
